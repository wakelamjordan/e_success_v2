{% extends 'base.html.twig' %}

{% block title %}{% endblock %}

{% block body %}
	<div class="position-relative">
		<div class="d-flex justify-content-between py-2">
			<div class="">
				<a name="" id="" class="btn btn-primary" href="javascript:newPeople()" role="button">
					<i class="fas fa-user-plus me-1"></i>Nouveau</a>
			</div>
			<div class="">
				<a name="" id="" class="btn btn-success ms-2 " href="javascript:showPeople()" role="button">
					<i class="fas fa-eye me-1"></i>Afficher</a>
				<a name="" id="" class="btn btn-warning ms-2 " href="javascript:editPeople()" role="button">
					<i class="fas fa-paintbrush me-1"></i>Modifier</a>
				<a name="" id="" class="btn btn-danger ms-2 " href="javascript:deletePeople()" role="button">
					<i class="fas fa-trash-can me-1"></i>Supprimer</a>
			</div>
		</div>
		<div class="table-responsive mvh-70">
			<table class="table table-light table-striped table-hover my-auto text-center">
				<thead class='position-sticky top-0'>
					<tr class="table-dark">
						<th class="col-1" scope="col">
							<input class="form-check-input mx-auto" type="checkbox" value="" id="select_all"/>
						</th>
						<th class="col-1" scope="col">Id</th>
						<th class="col-3" scope="col">Nom</th>
						<th class="col-2" scope="col">Prénom</th>
						<th class="col-2" scope="col">Date de naissance</th>
						<th class="col-3" scope="col">Lieu de naissance</th>
					</tr>
				</thead>
				<tbody>
					{% for people in peoples %}
						<tr class="">
							<td scope="row">
								<input class="form-check-input mx-auto" type="checkbox" value="{{people.id}}" id="{{people.id}}" name="checkbox_list"/>
							</td>
							<td class="">
								<label class="form-check-label" for="{{people.id}}">{{people.id}}</label>
							</td>
							<td class="">
								<label class="form-check-label" for="{{people.id}}">{{people.name}}</label>
							</td>
							<td class="">
								<label class="form-check-label" for="{{people.id}}">{{people.surname}}</label>
							</td>
							<td class="">
								<label class="form-check-label" for="{{people.id}}">{{people.getDateBirth()|date('d-m-Y')}}</label>
							</td>
							<td class="">
								<label class="form-check-label" for="{{people.id}}">{{people.getPlaceBirth()}}</label>
							</td>
						</tr>
					{% endfor %}
				</tbody>
				<tfoot class="position-sticky bottom-0">
					<tr class="table-dark">
						<td colspan="6" class="">Nombre de personnes enregistré :{{nbre}}</td>
					</tr>
				</tfoot>
			</table>
		</div>
	</div>
{% endblock %}
{% block script %}
	<script>
		function checked_id(checkboxes){
			//récupération de l'id du checkbox selectionné
			let array_id=[];
			checkboxes.forEach((checkbox)=>{
				array_id.push(checkbox.id);
			});
			return array_id;
		}

		function action(url_action){

			const checkboxes = document.querySelectorAll('input[type="checkbox"][name="checkbox_list"]:checked');
			let array_id = checked_id(checkboxes)
			let count =array_id.length;

			if(count>1){

				alert('Veuillez selectionner une ligne');

			}else{

				let id = parseInt(array_id[0]);
				let url = url_action.replace('id',id);
				document.location.href = url;
			}
		}

		function showPeople() {
			// let url_action = '/people/show/id';
			let url_action = '/people/show/id';
			action(url_action);
		}
		function editPeople() {
			let url_action = '/people/edit/id';
			action(url_action);
		}
		function newPeople() {
			let url_action = '/people/edit/id';
			action(url_action);
		}
		function deletePeople() {
			let url_action = '/people/delete/id';
			
			const checkboxes = document.querySelectorAll('input[type="checkbox"][name="checkbox_list"]:checked');
			let array_id = checked_id(checkboxes)
			let count =array_id.length;

			if(count>1){

				alert('Veuillez selectionner une ligne');

			}else if(confirm('Confirmez suppression?')){

				let id = parseInt(array_id[0]);
				let url = url_action.replace('id',id);
				document.location.href = url;
			}
		}
	</script>
{% endblock %}

	{# // <script>
		// 	const url_edit = "/people/edit/id";
	
	
	    //     function getCheckboxesChecked() {
	
	    //         let checkboxes_checked = document.querySelectorAll((input = '[type="checkbox"][name="checkbox_list"]:checked'));
	
	
	    //         var selected_values = [];
	
	    //         checkboxes_checked.forEach(function (checkbox) {
	
	    //             checkbox.addEventListener("change", function () {
	
	    //                 selected_values.push(this.value);
	
	    //             });
	    //         });
	    //         return selected_values;
	    //     }
	
	
	    //     function edit() {
	
	    //         alert('eeee');
	
	    //         // let selected_values = getCheckboxesChecked();
	
	    //         // console.log(selected_values);
	
	    //         // let count = selected_values.length;
	
	
	    //         // if (count > 1 || count == 0) {
	
	    //         //     alert("Veuillez sélectionner qu'un seul individu pour modifier");
	
	    //         // } else {
	
	    //         //     let id = selected_values[0];
	
	    //         //     const url = url_edit.replace("id", id);
	
	    //         //     document.location.href = url;
	    //         // }
	    //     }
		// </script> #}


